strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'gray') +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5)
View(map_segments)
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = x, xend = xend, y = y, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5)
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = xstart, xend = xend, y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5)
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5)
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'gray') +
scale_color_manual(vlaues = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'gray') +
scale_color_manual(vlaues = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'gray')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'gray') +
scale_color_manual(vlaues = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2, color = mut)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'black') +
scale_color_manual(vlaues = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'black') +
scale_color_manual(values = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
n_boot <- 500
random_landscapes <- data.frame(id = character(0),
dose = character(0),
knock_in = character(0),
slope = numeric(0),
R2 = numeric(0),
var_rel = numeric(0))
for (d in 1:length(unique(ge_data$dose))) {
df.rnd <- cbind(genot_matrix, fun = data[, 2 + d])
for (n in 1:n_boot) {
df.rnd$fun <- sample(df.rnd$fun)
ge_data.rnd.i <- makeGEdata(matrix2string(df.rnd))
for (m in unique(ge_data.rnd.i$knock_in)) {
lmod <- lm(d_f ~ background_f, data = ge_data.rnd.i[ge_data.rnd.i$knock_in == m, ])
random_landscapes <- rbind(random_landscapes,
data.frame(id = paste('rnd', d, n, sep = '.'),
dose = unique(ge_data$dose)[d],
knock_in = m,
slope = as.numeric(lmod$coefficients[2]),
R2 = summary(lmod)$r.squared,
var_rel = var(ge_data.rnd.i$d_f[ge_data.rnd.i$knock_in == m])/var(ge_data.rnd.i$background_f[ge_data.rnd.i$knock_in == m])))
}
}
}
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'gray') +
scale_color_manual(values = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'black') +
scale_color_manual(values = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)), geom = "raster", contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'grey50') +
scale_color_manual(values = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)),
geom = "raster",
contour = FALSE,
bins = 100) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'grey50') +
scale_color_manual(values = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)),
geom = "raster",
contour = FALSE,
bins = 50) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'grey50') +
scale_color_manual(values = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)),
geom = "raster",
contour = FALSE,
bins = 10) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'grey50') +
scale_color_manual(values = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggplot(random_landscapes,
aes(x = log10(var_rel), y = R2)) +
stat_density_2d(aes(fill = after_stat(density)),
geom = 'raster',
contour = FALSE) +
geom_arrowsegment(data = map_segments,
aes(x = log10(xstart), xend = log10(xend), y = ystart, yend = yend, color = mut),
arrow_positions = 1,
arrows = arrow(angle = 25,
type = 'open',
length = unit(0.25, "cm")),
linewidth = 0.5) +
geom_blank(data = epist_coords) +
scale_x_continuous(name = expression(paste('var ', Delta, italic(f), ' / ', 'var ', italic(f), '(', italic(B), ')', sep = '')),
breaks = c(-2, 0, 2),
labels = c(expression(10^-2),
expression(10^0),
expression(10^2)),
expand = c(0,0)) +
scale_y_continuous(name = expression(italic(R)^2),
breaks = c(0, 0.3, 0.6, 0.9),
expand = c(0,0)) +
scale_fill_gradient2(low = 'white', high = 'grey50') +
scale_color_manual(values = mut_colors) +
theme_bw() +
theme(aspect.ratio = 1,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 1),
legend.position = 'none')
ggsave(file = paste('../plots/epistMap_randomLandscapes_', saveplot, '.pdf', sep = ''),
device = 'pdf',
width = 75,
height = 75,
units = 'mm')
ggsave(file = paste('../plots/epistMap_randomLandscapes_', saveplot, '.pdf', sep = ''),
device = 'pdf',
width = 125,
height = 125,
units = 'mm')
source("~/GitHub/env_global_epist/scripts/analyze_data_new.R", echo=TRUE)
