panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.position = 'none',
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 0),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
ggplot(df, aes(x = background_f, y = d_f)) +
geom_point(data = df[df$color == 0, ],
color = 'black',
cex = 3) +
geom_smooth(aes(group = ellipse, color = ellipse),
method = 'lm',
formula = y ~ x,
se = F) +
geom_smooth(method = 'nls',
formula = y ~ p1*x^3*exp(-p2*(x - 0.2)),
se = F,
method.args = list(start = c(p1=1, p2=1)),
linetype = 'dashed',
color = mut_colors['C59R']) +
annotate("text",
x = 0.3, y = 0.005,
label = 'regional linear fit',
angle = -15,
color = 'gray',
size = 5) +
annotate("text",
x = 0.6, y = 0.15,
label = 'regional linear fit',
angle = -32,
color = mut_colors['S108N'],
size = 5) +
annotate("text",
x = 0, y = 0.5,
label = 'hypothetical\nnon-linear\n"global" fit',
color = mut_colors['C59R'],
size = 5) +
scale_x_continuous(name = expression(paste('Background fitness, ', italic(f), '(', italic(B), ')', sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_y_continuous(name = expression(paste('Fitness effect of C59R, ', Delta, italic(f), sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_color_manual(values = c('gray', as.character(mut_colors['S108N']))) +
theme_bw() +
theme(aspect.ratio = 0.6,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.position = 'none',
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 0),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
ggplot(df, aes(x = background_f, y = d_f)) +
geom_point(data = df[df$color == 0, ],
color = 'black',
cex = 3) +
geom_smooth(aes(group = ellipse, color = ellipse),
method = 'lm',
formula = y ~ x,
se = F) +
geom_smooth(method = 'nls',
formula = y ~ p1*x^3*exp(-p2*(x - 0.4)),
se = F,
method.args = list(start = c(p1=1, p2=1)),
linetype = 'dashed',
color = mut_colors['C59R']) +
annotate("text",
x = 0.3, y = 0.005,
label = 'regional linear fit',
angle = -15,
color = 'gray',
size = 5) +
annotate("text",
x = 0.6, y = 0.15,
label = 'regional linear fit',
angle = -32,
color = mut_colors['S108N'],
size = 5) +
annotate("text",
x = 0, y = 0.5,
label = 'hypothetical\nnon-linear\n"global" fit',
color = mut_colors['C59R'],
size = 5) +
scale_x_continuous(name = expression(paste('Background fitness, ', italic(f), '(', italic(B), ')', sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_y_continuous(name = expression(paste('Fitness effect of C59R, ', Delta, italic(f), sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_color_manual(values = c('gray', as.character(mut_colors['S108N']))) +
theme_bw() +
theme(aspect.ratio = 0.6,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.position = 'none',
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 0),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
ggplot(df, aes(x = background_f, y = d_f)) +
geom_point(data = df[df$color == 0, ],
color = 'black',
cex = 3) +
geom_smooth(aes(group = ellipse, color = ellipse),
method = 'lm',
formula = y ~ x,
se = F) +
geom_smooth(method = 'nls',
formula = y ~ p1*(x - 0.2)^3*exp(-p2*(x - 0.2)),
se = F,
method.args = list(start = c(p1=1, p2=1)),
linetype = 'dashed',
color = mut_colors['C59R']) +
annotate("text",
x = 0.3, y = 0.005,
label = 'regional linear fit',
angle = -15,
color = 'gray',
size = 5) +
annotate("text",
x = 0.6, y = 0.15,
label = 'regional linear fit',
angle = -32,
color = mut_colors['S108N'],
size = 5) +
annotate("text",
x = 0, y = 0.5,
label = 'hypothetical\nnon-linear\n"global" fit',
color = mut_colors['C59R'],
size = 5) +
scale_x_continuous(name = expression(paste('Background fitness, ', italic(f), '(', italic(B), ')', sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_y_continuous(name = expression(paste('Fitness effect of C59R, ', Delta, italic(f), sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_color_manual(values = c('gray', as.character(mut_colors['S108N']))) +
theme_bw() +
theme(aspect.ratio = 0.6,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.position = 'none',
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 0),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
ggplot(df, aes(x = background_f, y = d_f)) +
geom_point(data = df[df$color == 0, ],
color = 'black',
cex = 3) +
geom_smooth(aes(group = ellipse, color = ellipse),
method = 'lm',
formula = y ~ x,
se = F) +
geom_smooth(method = 'nls',
formula = y ~ p1*(x - 0.1)^3*exp(-p2*(x - 0.1)),
se = F,
method.args = list(start = c(p1=1, p2=1)),
linetype = 'dashed',
color = mut_colors['C59R']) +
annotate("text",
x = 0.3, y = 0.005,
label = 'regional linear fit',
angle = -15,
color = 'gray',
size = 5) +
annotate("text",
x = 0.6, y = 0.15,
label = 'regional linear fit',
angle = -32,
color = mut_colors['S108N'],
size = 5) +
annotate("text",
x = 0, y = 0.5,
label = 'hypothetical\nnon-linear\n"global" fit',
color = mut_colors['C59R'],
size = 5) +
scale_x_continuous(name = expression(paste('Background fitness, ', italic(f), '(', italic(B), ')', sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_y_continuous(name = expression(paste('Fitness effect of C59R, ', Delta, italic(f), sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_color_manual(values = c('gray', as.character(mut_colors['S108N']))) +
theme_bw() +
theme(aspect.ratio = 0.6,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.position = 'none',
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 0),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
ggplot(df, aes(x = background_f, y = d_f)) +
geom_point(data = df[df$color == 0, ],
color = 'black',
cex = 3) +
geom_smooth(aes(group = ellipse, color = ellipse),
method = 'lm',
formula = y ~ x,
se = F) +
geom_smooth(method = 'nls',
formula = y ~ p1*(x - 0.1)^3*exp(-p2*x),
se = F,
method.args = list(start = c(p1=1, p2=1)),
linetype = 'dashed',
color = mut_colors['C59R']) +
annotate("text",
x = 0.3, y = 0.005,
label = 'regional linear fit',
angle = -15,
color = 'gray',
size = 5) +
annotate("text",
x = 0.6, y = 0.15,
label = 'regional linear fit',
angle = -32,
color = mut_colors['S108N'],
size = 5) +
annotate("text",
x = 0, y = 0.5,
label = 'hypothetical\nnon-linear\n"global" fit',
color = mut_colors['C59R'],
size = 5) +
scale_x_continuous(name = expression(paste('Background fitness, ', italic(f), '(', italic(B), ')', sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_y_continuous(name = expression(paste('Fitness effect of C59R, ', Delta, italic(f), sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_color_manual(values = c('gray', as.character(mut_colors['S108N']))) +
theme_bw() +
theme(aspect.ratio = 0.6,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.position = 'none',
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 0),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
ggplot(df, aes(x = background_f, y = d_f)) +
geom_point(data = df[df$color == 0, ],
color = 'black',
cex = 3) +
geom_smooth(aes(group = ellipse, color = ellipse),
method = 'lm',
formula = y ~ x,
se = F) +
geom_smooth(method = 'nls',
formula = y ~ abs(p1*(x - 0.1)^3*exp(-p2*x)),
se = F,
method.args = list(start = c(p1=1, p2=1)),
linetype = 'dashed',
color = mut_colors['C59R']) +
annotate("text",
x = 0.3, y = 0.005,
label = 'regional linear fit',
angle = -15,
color = 'gray',
size = 5) +
annotate("text",
x = 0.6, y = 0.15,
label = 'regional linear fit',
angle = -32,
color = mut_colors['S108N'],
size = 5) +
annotate("text",
x = 0, y = 0.5,
label = 'hypothetical\nnon-linear\n"global" fit',
color = mut_colors['C59R'],
size = 5) +
scale_x_continuous(name = expression(paste('Background fitness, ', italic(f), '(', italic(B), ')', sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_y_continuous(name = expression(paste('Fitness effect of C59R, ', Delta, italic(f), sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_color_manual(values = c('gray', as.character(mut_colors['S108N']))) +
theme_bw() +
theme(aspect.ratio = 0.6,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.position = 'none',
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 0),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
formula = y ~ max(c((p1*(x - 0.1)^3*exp(-p2*x), 0)),
ggplot(df, aes(x = background_f, y = d_f)) +
geom_point(data = df[df$color == 0, ],
color = 'black',
cex = 3) +
geom_smooth(aes(group = ellipse, color = ellipse),
method = 'lm',
formula = y ~ x,
se = F) +
geom_smooth(method = 'nls',
formula = y ~ max(c((p1*(x - 0.1)^3*exp(-p2*x), 0))),
se = F,
method.args = list(start = c(p1=1, p2=1)),
linetype = 'dashed',
color = mut_colors['C59R']) +
annotate("text",
x = 0.3, y = 0.005,
label = 'regional linear fit',
angle = -15,
color = 'gray',
size = 5) +
annotate("text",
x = 0.6, y = 0.15,
label = 'regional linear fit',
angle = -32,
color = mut_colors['S108N'],
size = 5) +
annotate("text",
x = 0, y = 0.5,
label = 'hypothetical\nnon-linear\n"global" fit',
color = mut_colors['C59R'],
size = 5) +
scale_x_continuous(name = expression(paste('Background fitness, ', italic(f), '(', italic(B), ')', sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_y_continuous(name = expression(paste('Fitness effect of C59R, ', Delta, italic(f), sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_color_manual(values = c('gray', as.character(mut_colors['S108N']))) +
theme_bw() +
theme(aspect.ratio = 0.6,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.position = 'none',
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 0),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
ggplot(df, aes(x = background_f, y = d_f)) +
geom_point(data = df[df$color == 0, ],
color = 'black',
cex = 3) +
geom_smooth(aes(group = ellipse, color = ellipse),
method = 'lm',
formula = y ~ x,
se = F) +
geom_smooth(method = 'nls',
formula = y ~ (p1*(x - 0.1)^3*exp(-p2*x), 0),
se = F,
method.args = list(start = c(p1=1, p2=1)),
linetype = 'dashed',
color = mut_colors['C59R']) +
annotate("text",
x = 0.3, y = 0.005,
label = 'regional linear fit',
angle = -15,
color = 'gray',
size = 5) +
annotate("text",
x = 0.6, y = 0.15,
label = 'regional linear fit',
angle = -32,
color = mut_colors['S108N'],
size = 5) +
annotate("text",
x = 0, y = 0.5,
label = 'hypothetical\nnon-linear\n"global" fit',
color = mut_colors['C59R'],
size = 5) +
scale_x_continuous(name = expression(paste('Background fitness, ', italic(f), '(', italic(B), ')', sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_y_continuous(name = expression(paste('Fitness effect of C59R, ', Delta, italic(f), sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_color_manual(values = c('gray', as.character(mut_colors['S108N']))) +
theme_bw() +
theme(aspect.ratio = 0.6,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.position = 'none',
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 0),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
ggplot(df, aes(x = background_f, y = d_f)) +
geom_point(data = df[df$color == 0, ],
color = 'black',
cex = 3) +
geom_smooth(aes(group = ellipse, color = ellipse),
method = 'lm',
formula = y ~ x,
se = F) +
geom_smooth(method = 'nls',
formula = y ~ p1*(x - 0.1)^3*exp(-p2*x),
se = F,
method.args = list(start = c(p1=1, p2=1)),
linetype = 'dashed',
color = mut_colors['C59R']) +
annotate("text",
x = 0.3, y = 0.005,
label = 'regional linear fit',
angle = -15,
color = 'gray',
size = 5) +
annotate("text",
x = 0.6, y = 0.15,
label = 'regional linear fit',
angle = -32,
color = mut_colors['S108N'],
size = 5) +
annotate("text",
x = 0, y = 0.5,
label = 'hypothetical\nnon-linear\n"global" fit',
color = mut_colors['C59R'],
size = 5) +
scale_x_continuous(name = expression(paste('Background fitness, ', italic(f), '(', italic(B), ')', sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_y_continuous(name = expression(paste('Fitness effect of C59R, ', Delta, italic(f), sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_color_manual(values = c('gray', as.character(mut_colors['S108N']))) +
theme_bw() +
theme(aspect.ratio = 0.6,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.position = 'none',
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 0),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
ggplot(df, aes(x = background_f, y = d_f)) +
geom_point(data = df[df$color == 0, ],
color = 'black',
cex = 3) +
geom_smooth(aes(group = ellipse, color = ellipse),
method = 'lm',
formula = y ~ x,
se = F) +
geom_smooth(method = 'nls',
formula = y ~ p1*x^3*exp(-p2*x),
se = F,
method.args = list(start = c(p1=1, p2=1)),
linetype = 'dashed',
color = mut_colors['C59R']) +
annotate("text",
x = 0.3, y = 0.005,
label = 'regional linear fit',
angle = -15,
color = 'gray',
size = 5) +
annotate("text",
x = 0.6, y = 0.15,
label = 'regional linear fit',
angle = -32,
color = mut_colors['S108N'],
size = 5) +
annotate("text",
x = 0, y = 0.5,
label = 'hypothetical\nnon-linear\n"global" fit',
color = mut_colors['C59R'],
size = 5) +
scale_x_continuous(name = expression(paste('Background fitness, ', italic(f), '(', italic(B), ')', sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_y_continuous(name = expression(paste('Fitness effect of C59R, ', Delta, italic(f), sep = '')),
breaks = pretty_breaks(n = 3),
expand = c(0.1, 0.1)) +
scale_color_manual(values = c('gray', as.character(mut_colors['S108N']))) +
theme_bw() +
theme(aspect.ratio = 0.6,
panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(size = 16, vjust = 0),
axis.title = element_text(size = 18),
axis.text = element_text(size = 16),
legend.position = 'none',
legend.title = element_text(size = 16),
legend.text = element_text(size = 14, hjust = 0),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
source("~/GitHub/env_global_epist/scripts/analyze_data_new.R", echo=TRUE)
